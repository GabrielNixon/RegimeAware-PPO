# Financial Analysis Repository

This repository contains a comprehensive financial analysis of asset returns, portfolio optimization, and risk assessment, using historical financial data primarily sourced from "Finance Portfolio 2.csv," provided by Professor Aswath Damodaran of New York University (NYU).

---

## Dataset Overview

### Finance Portfolio 2.csv

The primary dataset, "Finance Portfolio 2.csv," provided by Professor Aswath Damodaran from NYU, contains historical annual returns for various asset classes, including:

* Equities (e.g., S\&P 500, Small Cap)
* Bonds (e.g., 10-Year Treasury, Baa Corporate)
* Real Estate
* Commodities (e.g., Gold)
* Risk-free assets (e.g., T-Bills)

The dataset spans extensive historical periods, capturing multiple economic cycles and critical financial stress periods (1931, 1974, 1987, 2001, 2008, and 2020), making it particularly suitable for analyzing asset behavior under varied market conditions and for robust portfolio risk management strategies.

### cleaned\_real\_asset\_returns.csv

A cleaned and processed version of the original dataset, optimized for computational analysis. Generated by running the script `cleaned_real_asset_returns.py`, it contains standardized and formatted returns data suitable for analytical tasks.

---

## Python Scripts

### Standard Financial Analysis Scripts

* **`cleaned_real_asset_returns.py`**: Script for cleaning and processing raw data.
* **`sharpe_stress_analysis.py`**: Computes Sharpe ratios for assets during stress and non-stress periods.
* **`rolling_sharpe_analysis.py`**: Calculates rolling Sharpe ratios over 2-, 5-, and 10-year windows.
* **`centered_window_analysis.py`**: Performs Sharpe ratio calculations around stress years using centered windows.
* **`bootstrap_ci.py`**: Generates bootstrap confidence intervals for cumulative returns using Monte Carlo simulations.
* **`resilience_analysis.py`**: Computes resilience scores based on volatility, cumulative return, and CAGR.
* **`pca_resilience.py`**: Applies PCA to derive resilience scores for assets.
* **`portfolio_optimization.py`**: Optimizes asset portfolio based on maximizing Sharpe ratio.
* **`sortino_optimization.py`**: Performs portfolio optimization focusing on maximizing Sortino ratio.
* **`factor_attribution.py`**: Conducts factor attribution analysis using the Fama-French + Momentum factors.
* **`drawdown_analysis.py`**: Calculates the maximum historical drawdown for each asset.
* **`rolling_factor_analysis.py`**: Calculates rolling betas and performs statistical diagnostic tests on factor regression residuals.

### Regime-Aware AI Extensions

* **`regime_features.py`**: Extracts regime-related features such as drawdown, volatilities, spreads.
* **`regime_clustering.py`**: Applies KMeans, GMM, and HMM for unsupervised regime detection.
* **`regime_classification.py`**: Uses Autoencoder, Random Forest, and XGBoost for supervised regime classification.
* **`monte_carlo_simulation.py`**: Runs regime-aware Monte Carlo simulation with static transition probabilities.
* **`enhanced_monte_carlo.py`**: Extends Monte Carlo simulation using macroeconomic inputs for dynamic regime modeling.
* **`regime_rl_env.py`**: Custom OpenAI Gym environment using HMM regime probabilities as state input.
* **`ppo_train_regime_rl.py`**: Trains a PPO agent using stable-baselines3 to learn optimal portfolio strategies based on regime-aware signals.
* **`ppo_rl_pipeline.py`**: Basic PPO agent with simple reward function.
* **`ppo_rl_stable.py`**: Final implementation with transaction cost modeling, volatility-adjusted reward, clipping, capital reset, and shock simulation.
* **`ppo_advanced_vs_equal_returns.csv`**: Final evaluation data comparing PPO, Equal Weight, and Sharpe-Optimized portfolios.
* **`rolling_cagr_comparison_all_strategies.png`**: Rolling CAGR plot (10y, 20y, 30y) across all strategies.
* **`ppo_vs_equal_portfolio_growth.png`**: Final value growth chart.

---

## Results

* **`analysis_results.md`**: Summarizes all results from traditional portfolio analysis.
* **`results.md`**: Summarizes regime-aware Monte Carlo simulation, clustering quality, and RL-based outcomes.
* **`rl_analysis_report.md`**: Detailed summary of the PPO reinforcement learning portfolio training and evaluation pipeline.

---

## Analysis Components

* Sharpe and Sortino ratio calculations
* Monte Carlo simulations with fixed and dynamic regimes
* PCA-based resilience scoring
* Portfolio optimization (Sharpe, Sortino)
* Factor attribution with Fama-French + Momentum
* Regime clustering with KMeans, GMM, and HMM
* Supervised regime prediction
* Reinforcement learning-based portfolio optimization
* Risk assessment: VaR, CVaR, and max drawdown
* Regime-aware training with PPO
* Evaluation of PPO against equal-weight and optimized portfolios
* Rolling CAGR analysis and stress testing

---

## Usage

Run each `.py` script sequentially. For regime-aware modules, ensure input files like `regime_features.csv` and `returns_matrix.csv` are available.

```bash
python cleaned_real_asset_returns.py
python sharpe_stress_analysis.py
...
python regime_features.py
python regime_clustering.py
python regime_classification.py
python monte_carlo_simulation.py
python enhanced_monte_carlo.py
python ppo_train_regime_rl.py
python ppo_rl_stable.py
```

---

## Dependencies

* Python 3.8+
* pandas
* numpy
* scipy
* statsmodels
* scikit-learn
* matplotlib
* hmmlearn
* xgboost
* tensorflow
* stable-baselines3
* gymnasium

Install them using:

```bash
pip install pandas numpy scipy statsmodels scikit-learn matplotlib hmmlearn xgboost tensorflow stable-baselines3 gymnasium
```

---

## Contribution

Feel free to suggest improvements or submit pull requests.
